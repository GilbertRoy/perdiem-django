{% extends "base.html" %}
{% load staticfiles %}
{% load thumbnail %}
{% load markdown_deux_tags %}
{% load music %}

{% block content %}
    <h2>{{ album.name }}</h2>
    <h4>BY {{ album.project.artist.name }}</h4>
    <div class="project-image">
        {% thumbnail album.artwork.img "500x500" crop="center" as thumb %}
            <img src="{{ thumb.url }}" width="{{ thumb.width }}" height="{{ thumb.height }}" alt="{{ album.name }}" />
        {% endthumbnail %}
    </div>
    {% if album.release_date %}
        <h4>Release date: {{ album.release_date }}</h4>
    {% endif %}
    {% if album.discs %}
        <h4>TRACK LISTING</h4>
        {% for disc in album.discs %}
            <ol>
                {% for track in disc %}
                    <li>{{ track.name }} [{{ track.duration|trackdurationformat }}]</li>
                {% endfor %}
            </ol>
        {% endfor %}
    {% endif %}
    {% if album.albumbio %}
        <h4>About</h4>
        <div class="break-small">
            <hr>
        </div>
        <div class="album-bio">
            <p>{{ album.albumbio.bio|markdown }}</p>
        </div>
    {% endif %}

    {% if album.marketplaceurl_set.all %}
        <h4>LISTEN / PURCHASE</h4>
        <div class="break-small">
            <hr>
        </div>
        <div class="marketplace-container">
            {% for marketplace_url in album.marketplaceurl_set.all %}
                <a href="{{ marketplace_url.url }}" target="_blank">
                    {% with "img/marketplace/"|add:marketplace_url.medium|add:".svg" as medium_image %}
                        <img class="marketplace-icons" src="{% static medium_image %}" alt="{{ marketplace_url.get_medium_display }}" />
                    {% endwith %}
                </a>
            {% endfor %}
        </div>
        <br />
    {% endif %}

    {% if user_is_investor %}
        <h4>FOR INVESTORS</h4>
        <div class="break-small">
            <hr>
        </div>
        <div class="download-container">
            <a class="download-button" href="{{ album.audio.get_temporary_url }}" download>
                Download
                <i class="fa fa-download" aria-hidden="true"></i>
            </a>
        </div>
    {% endif %}
{% endblock %}
